/**
 * walk dom element
 *
 * @param {DOM}   el
 * @param {Function}   action
 * @param {Function} done
 */function walk(a,b,c){function d(a){return a||0===e.length?c():void walk(e.shift(),b,d)}var e=a.childNodes&&[].slice.call(a.childNodes);c=c||function(){},b=b||function(){},b(a,d)}var tagRE=/\{\{((?:.|\n)+?)\}\}/g,parse={text:function(a){// reference: https://github.com/vuejs/vue/blob/dev/src/compiler/parser/text-parser.js#L15-L41
if(!tagRE.test(a))return JSON.stringify(a);for(var b,c,d=[],e=tagRE.lastIndex=0;c=tagRE.exec(a);)b=c.index,b>e&&d.push(JSON.stringify(a.slice(e,b))),d.push(c[1].trim()),e=b+c[0].length;return e<a.length&&d.push(JSON.stringify(a.slice(e))),d.join("+")}};/**
 * Converts a string into a DOM element
 *
 * @param {String} DOMString
 * @return {DOM}
 */function domify(a){var b=document.implementation.createHTMLDocument();return b.body.innerHTML=a,b.body.children}var defaults={template:"",data:{}};function each(a,b){var c,d=0;if(Array.isArray(a)){for(c=a.length;d<c;d++)if(!1===b.call(a[d],a[d],d))return a;}else for(d in a)if(!1===b.call(a[d],a[d],d))return a;return a}function type(a){var b={},c=b.toString.call(a);return null==a?""+a:("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(a){return b["[object "+a+"]"]=a.toLowerCase()}),"object"==typeof a||"function"==typeof a?b[c]||"object":typeof a)}function isPlainObject(a){var b,c,d={},e=d.toString,f=d.hasOwnProperty,g=f.toString,h=g.call(Object);return!!(a&&"[object Object]"===e.call(a))&&(!(b=Object.getPrototypeOf(a),!!b)||(c=f.call(b,"constructor")&&b.constructor,"function"==typeof c&&g.call(c)===h))}/**
 * Extend object
 *
 * @method extend
 * @return {Object} object
 */function extend(){var a,b,c,d,e,f,g=arguments,h=arguments[0]||{},j=1,k=arguments.length,l=!1;for("boolean"==typeof h&&(l=h,h=arguments[j]||{},j++),"object"!=typeof h&&"function"!==type(h)&&(h={}),j===k&&(h=this,j--);j<k;j++)//
if(null!==(a=g[j]))// for in source object
for(b in a)(e=h[b],d=a[b],h!=d)&&(l&&d&&(isPlainObject(d)||(f=Array.isArray(d)))?(f?(f=!1,c=e&&Array.isArray(e)?e:[]):c=e&&isPlainObject(e)?e:{},h[b]=extend(l,c,d)):void 0!==d&&(h[b]=d));// deep clone
return h}var configure={identifier:{bind:":"},priority:["each"]},IF={beforeUpdate:function(){this.holder=document.createComment(""+configure.identifier.bind+this.name),this.node.parentNode.replaceChild(this.holder,this.node)},update:function(a){a&&this.holder.parentNode.replaceChild(this.node,this.holder)}},src={update:function(a){this.node.setAttribute(this.name,a)}},show={update:function(a){this.node.style.display=a?"block":"none"}},text={update:function(a){this.node.textContent=a}},each$1={beforeUpdate:function(){if(this.holder=document.createComment(""+configure.identifier.bind+this.name),this.node.parentNode.replaceChild(this.holder,this.node),this.itemName="item",this.indexName="index",this.dataName=this.expression,-1!=this.expression.indexOf(" in ")){var a=/\(((?:.|\n)+?)\)/g,b=this.expression.split(" in "),c=b[0],d=b[1],e=a.exec(c);if(e){var f=e[1].split(","),g=f[0],h=f[1];h?this.indexName=h.trim():"",this.itemName=g.trim()}else this.itemName=c.trim();this.dataName=d.trim()}this.expression=this.dataName},update:function(a){var b=this;if(a&&!Array.isArray(a))return!1;var c=document.createDocumentFragment();a.map(function(a,d){var e,f=colon({template:b.node.cloneNode(!0),data:(e={},e[b.itemName]=a,e[b.indexName]=d,e)});c.appendChild(f.options.template)}),this.holder.parentNode.replaceChild(c,this.holder)}},style={update:function(a){var b=this;each(a,function(a,c){"object"===type(a)?each(a,function(a,c){return b.node.style[c]=a}):b.node.style[c]=a})}};// reference: https://github.com/vuejs/vue/blob/dev/src/platforms/web/runtime/class-util.js#L7-L26
function addClass(a,b){if(b&&(b=b.trim()))if(a.classList)-1<b.indexOf(" ")?b.split(/\s+/).forEach(function(b){return a.classList.add(b)}):a.classList.add(b);else{var c=" "+(a.getAttribute("class")||"")+" ";0>c.indexOf(" "+b+" ")&&a.setAttribute("class",(c+b).trim())}}// reference: https://github.com/vuejs/vue/blob/dev/src/platforms/web/runtime/class-util.js#L32-L61
function removeClass(a,b){if(b&&(b=b.trim()))if(a.classList)-1<b.indexOf(" ")?b.split(/\s+/).forEach(function(b){return a.classList.remove(b)}):a.classList.remove(b),a.classList.length||a.removeAttribute("class");else{for(var c=" "+(a.getAttribute("class")||"")+" ",d=" "+b+" ";0<=c.indexOf(d);)c=c.replace(d," ");c=c.trim(),c?a.setAttribute("class",c):a.removeAttribute("class")}}var clus={update:function(a){var b=this;each(a,function(a,c){if("object"===type(a))each(a,function(a,c){return a?addClass(b.node,c):removeClass(b.node,c)});else{var d="number"===type(c)?a:c;a?addClass(b.node,d):removeClass(b.node,d)}})}},attribute={update:function(a){this.node.setAttribute(this.attrName,a)}},directives={IF:IF,src:src,show:show,text:text,each:each$1,style:style,clus:clus,attribute:attribute},dependencyRE=/"[^"]*"|'[^']*'|\.\w*[a-zA-Z$_]\w*|\w*[a-zA-Z$_]\w*:|(\w*[a-zA-Z$_]\w*)/g,globals=["true","false","undefined","null","NaN","isNaN","typeof","in","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","unescape","escape","eval","isFinite","Number","String","parseFloat","parseInt"];function generate(a){var b=extractDependencies(a),c=b.reduce(function(a,b){return a+="var "+b+" = data[\""+b+"\"]; ",a},"");return new Function("data",c+"return "+a+";")}function extractDependencies(a){var b=[];return a.replace(dependencyRE,function(a,c){!function(a){return void 0!==a}(c)||function(a,b){return a.includes(b)}(b,c)||function(a,b){return a.includes(b)}(globals,c)||b.push(c)}),b}var Directive=function(a){void 0===a&&(a={}),"if"===a.name&&(a.name="IF"),"class"===a.name&&(a.name="clus"),Object.assign(this,a),Object.assign(this,directives[this.name]),this.beforeUpdate&&this.beforeUpdate(),this.update&&this.update(generate(this.expression)(this.compile.data))},hasInterpolation=function(a){return /\{?\{\{(.+?)\}\}\}?/g.test(a)};function Compile(a,b){var c,d=this;return void 0===b&&(b={}),this instanceof Compile?void(a instanceof Node?b.template=a:"string"==typeof a?(c=domify(a),a=c[0],b.template=a):"string"!=typeof a&&(b=a),this.options=extend(!0,defaults,b),this.data=this.options.data,a=this.options.template,walk(a,function(a,b){if(1===a.nodeType){var c=d.compile.elementNodes.call(d,a);return b(!1===c)}3===a.nodeType&&d.compile.textNodes.call(d,a),b()}),this.view=a,a=null):new Compile(a,b)}Compile.prototype.compile={},Compile.prototype.compile.elementNodes=function(a){var b=this;if(a.hasAttributes()&&this.bindPriority(a))return!1;var c=[].slice.call(a.attributes);c.map(function(c){var d=c.name,e=c.value.trim();if(0===d.indexOf(configure.identifier.bind)&&""!==e){var f=d.slice(configure.identifier.bind.length);b.bindDirective({node:a,expression:e,name:f}),a.removeAttribute(d)}else b.bindAttribute(a,c)})},Compile.prototype.compile.textNodes=function(a){return""!==a.textContent.trim()&&void this.bindDirective({node:a,name:"text",expression:parse.text(a.textContent)})},Compile.prototype.bindDirective=function(a){a.compile=this,new Directive(a)},Compile.prototype.bindAttribute=function(a,b){return!!(hasInterpolation(b.value)&&""!=b.value.trim())&&void this.bindDirective({node:a,name:"attribute",expression:parse.text(b.value),attrName:b.name})},Compile.prototype.bindPriority=function(a){for(var b=0;b<configure.priority.length;b++){var c=configure.priority[b],d=a.getAttribute(""+configure.identifier.bind+c);return!!d&&(d=d.trim(),!!d)&&(a.removeAttribute(""+configure.identifier.bind+c),this.bindDirective({node:a,name:c,expression:d}),!0)}};function initCompile(a){a.view=Compile(a.options.template,{data:a.options.data}).view}function initComputed(a){var b=a.options.computed;if(!b)return!1;for(var c in b){var d=b[c];"function"==typeof d&&Object.defineProperty(a.options.data,c,{get:d,enumerable:!0,configurable:!0})}}function init(a){initComputed(a),initCompile(a)}function colon(a){return this instanceof colon?void(this.options=a,init(this)):new colon(a)}export default colon;
//# sourceMappingURL=colon.es.min.js.map
